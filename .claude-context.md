# D2 Sanitizers - Project Context

## Project Overview
D2 Sanitizers is a modern web application for professional sanitization solutions. This project is built with a focus on performance, scalability, and developer experience.

## Tech Stack

### Core Technologies
- **Astro 5.x** - Modern static site builder with partial hydration
- **React 18.3** - For interactive components (cart) using Astro islands
- **TypeScript** - Strict type checking enabled
- **Tailwind CSS v4** - Utility-first CSS framework via Vite plugin
- **Cloudinary** - Image and video hosting with automatic optimization
- **Node.js** - Runtime environment

### E-commerce & Media
- **Shopify Storefront API** - Headless commerce (fetch-based, no SDK)
- **Cloudinary** - CDN for images and videos with transformations

### Deployment
- **Vercel** - Recommended deployment platform (configuration needed)

## Project Structure

```
D2/
├── src/
│   ├── components/     # Reusable UI components
│   ├── layouts/        # Page layout components
│   │   └── Layout.astro
│   ├── pages/          # File-based routing
│   │   ├── index.astro
│   │   ├── login.astro
│   │   ├── signup.astro
│   │   └── dashboard.astro
│   ├── styles/         # Global styles
│   │   └── global.css  # Tailwind CSS imports
│   ├── lib/            # Shared libraries and utilities
│   └── utils/          # Helper functions
├── public/             # Static assets
├── .env.example        # Environment variables template
├── astro.config.mjs    # Astro configuration
├── package.json        # Dependencies and scripts
└── tsconfig.json       # TypeScript configuration
```

## Development Workflow

### Getting Started

1. **Install Dependencies**
   ```bash
   npm install
   ```

2. **Environment Setup**
   ```bash
   cp .env.example .env
   # Edit .env with your environment variables
   ```

3. **Start Development Server**
   ```bash
   npm run dev
   ```
   Server runs at http://localhost:4321

### Available Scripts

- `npm run dev` - Start development server
- `npm run build` - Build for production
- `npm run preview` - Preview production build locally

## Key Features & Pages

### Current Pages

1. **Home Page** (`/`)
   - Landing page with hero section
   - Links to login and signup

2. **Login Page** (`/login`)
   - User authentication form
   - Link to signup page

3. **Signup Page** (`/signup`)
   - New user registration form
   - Link to login page

4. **Dashboard** (`/dashboard`)
   - Protected route (authentication pending)
   - Stats cards for orders, clients, and revenue

## Styling

### Tailwind CSS v4
- Configured via `@tailwindcss/vite` plugin
- Global styles imported in `src/styles/global.css`
- Imported in Layout component for all pages

### Design System
- Primary color: Indigo (indigo-600, indigo-700)
- Background: Gray-50 for main areas
- Cards: White with shadow-md
- Forms: Consistent styling with focus states

## Image and Video Handling with Cloudinary

### Why Custom CloudinaryImage Component?

We use a custom `CloudinaryImage` component instead of Astro's built-in `Image` component to:
- Leverage Cloudinary's automatic format optimization (WebP/AVIF)
- Use Cloudinary's global CDN for faster delivery
- Apply on-the-fly transformations (crop, resize, quality)
- Avoid conflicts with Astro's image optimization pipeline
- Maintain consistent image delivery across environments

### CloudinaryImage Component

Located at `src/components/CloudinaryImage.astro`

**Props:**
- `publicId` (required) - Cloudinary public ID
- `alt` (required) - Alt text for accessibility
- `width` - Target width in pixels
- `height` - Target height in pixels
- `crop` - Crop mode: 'fill', 'fit', 'scale', 'crop', 'thumb', 'limit', 'pad', 'lfill', 'mfit'
- `quality` - Image quality: number or 'auto' (default: 'auto')
- `format` - Output format: 'auto', 'webp', 'jpg', 'png' (default: 'auto')
- `class` - CSS classes
- `loading` - 'lazy' or 'eager' (default: 'lazy')
- `sizes` - Responsive sizes attribute
- `aspectRatio` - Preserve aspect ratio (e.g., '16/9')

**Usage Examples:**

```astro
import CloudinaryImage from '../components/CloudinaryImage.astro';

<!-- Hero Image -->
<CloudinaryImage
  publicId="d2-sanitizers/hero-banner"
  alt="D2 Sanitizers facility"
  width={1600}
  height={600}
  crop="fill"
  class="w-full h-auto"
/>

<!-- Product Thumbnail -->
<CloudinaryImage
  publicId="products/sanitizer-bottle"
  alt="Hand sanitizer bottle"
  width={400}
  height={400}
  crop="fill"
  quality="auto"
  class="rounded-lg shadow-md"
/>

<!-- Responsive Gallery Image -->
<CloudinaryImage
  publicId="gallery/facility-tour"
  alt="Facility tour"
  width={800}
  aspectRatio="16/9"
  class="w-full"
/>
```

### Cloudinary Utility Functions

Located at `src/lib/cloudinary.ts`

**Available Functions:**

```typescript
// Build optimized image URL with transformations
buildCloudinaryUrl({
  publicId: 'folder/image',
  width: 800,
  height: 600,
  crop: 'fill',
  quality: 'auto',
  format: 'auto'
})

// Generate responsive srcset
getCloudinaryResponsiveSet({
  publicId: 'folder/image',
  sizes: [400, 800, 1200, 1600],
  crop: 'fill',
  quality: 'auto'
})

// Get video URL
getCloudinaryVideoUrl('folder/video-name')

// Get basic image URL
getCloudinaryImageUrl('folder/image')
```

### Video Backgrounds

The Hero component supports Cloudinary videos:

```astro
<Hero
  cloudinaryVideoId="d2-sanitizers/hero-background"
  heading="Welcome to D2 Sanitizers"
  description="..."
/>
```

### Best Practices

1. **Always use `quality="auto"`** for automatic optimization
2. **Use `format="auto"`** to serve WebP/AVIF when supported
3. **Specify dimensions** for better layout stability
4. **Use lazy loading** for images below the fold
5. **Organize assets** in folders within Cloudinary (e.g., `products/`, `hero/`, `gallery/`)
6. **Test responsive images** on different screen sizes

### Test Page

Visit `/test-images` to see all CloudinaryImage features in action with real examples from the `southland-organics` cloud.

## Environment Variables

All public environment variables must be prefixed with `PUBLIC_` to be available on the client-side.

**Required Variables:**

```env
# Cloudinary (for images and videos)
PUBLIC_CLOUDINARY_CLOUD_NAME=southland-organics
PUBLIC_CLOUDINARY_API_KEY=your-api-key
CLOUDINARY_API_SECRET=your-api-secret

# Shopify Storefront API
PUBLIC_SHOPIFY_STORE_DOMAIN=your-store.myshopify.com
PUBLIC_SHOPIFY_STOREFRONT_ACCESS_TOKEN=your-storefront-token

# Site Configuration
PUBLIC_SITE_URL=http://localhost:4321
```

## Deployment

### Vercel Setup (Recommended)

1. Install Vercel CLI:
   ```bash
   npm i -g vercel
   ```

2. Deploy:
   ```bash
   vercel
   ```

3. Set environment variables in Vercel dashboard

### Build Configuration
- Output: Static (default) or Hybrid/Server mode (via adapter)
- Build command: `npm run build`
- Output directory: `dist/`

## Future Enhancements

- [ ] Add authentication system
- [ ] Integrate backend API
- [ ] Add database integration
- [ ] Implement dashboard functionality
- [ ] Add form validation
- [ ] Create component library
- [ ] Add unit and integration tests
- [ ] Set up CI/CD pipeline

## Development Guidelines

### Code Style
- Use TypeScript strict mode
- Follow Astro component conventions
- Use functional components when possible
- Keep components small and focused

### File Naming
- Components: PascalCase (e.g., `Button.astro`)
- Pages: lowercase (e.g., `index.astro`, `login.astro`)
- Utilities: camelCase (e.g., `formatDate.ts`)

### Git Workflow
- Feature branches from main
- Descriptive commit messages
- Pull requests for review

## Troubleshooting

### Common Issues

1. **Tailwind styles not working**
   - Ensure `global.css` is imported in Layout
   - Check Tailwind v4 configuration in `astro.config.mjs`

2. **TypeScript errors**
   - Run `npm run build` to check for type errors
   - Check `tsconfig.json` for configuration

3. **Port already in use**
   - Change port: `npm run dev -- --port 3000`

## Resources

- [Astro Documentation](https://docs.astro.build)
- [Tailwind CSS v4 Docs](https://tailwindcss.com/docs)
- [TypeScript Documentation](https://www.typescriptlang.org/docs)
- [Vercel Documentation](https://vercel.com/docs)